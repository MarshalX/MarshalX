{"componentChunkName":"component---src-templates-post-jsx","path":"/blog/post/xss-ne-eskeypnutye-dannye-u-yandeks","result":{"data":{"prismicPost":{"id":"Prismic__Post__XokyZBAAACMArb6k","uid":"xss-ne-eskeypnutye-dannye-u-yandeks","first_publication_date":"2020-04-05T01:20:39+0000","last_publication_date":"2020-04-09T11:51:20+0000","data":{"title":{"text":"XSS. Не эскейпнутые данные у Яндекс"},"description":"Я хотел начать орать, но рано. Тип яндух сохраняет и отдает не экранированные данные, а потом вспомнил, ШО ТАК И НАДО!\n\nЗнаете же какая лучшая практика против XSS всяких? Экранировать при ВЫВОДЕ, а не ВВОДЕ!","date":"04.01.2020","categories":[{"category":{"document":[{"id":"Prismic__Category__Xm56eREAACMACBYT","uid":"poznavatelno","data":{"name":"Познавательно"}}]}}],"body":[{"__typename":"PrismicPostBodyImage","slice_type":"image","id":"Prismic__PostBodyImage__Prismic__Post__XokyZBAAACMArb6k__body__0","primary":{"image":{"localFile":{"id":"332a966c-5c42-5aff-9125-26732d61062a","childImageSharp":{"id":"054dbf9d-8e3a-5de5-8bc2-8615989d39c2","fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEE/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcQsgP/EABUQAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEBAAEFAlV//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bh//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAWEAADAAAAAAAAAAAAAAAAAAAAEEH/2gAIAQEABj8CUP/EABoQAAICAwAAAAAAAAAAAAAAAAABEXEhMZH/2gAIAQEAAT8hnGkUXCo//9oADAMBAAIAAwAAABCML//EABYRAQEBAAAAAAAAAAAAAAAAABEAAf/aAAgBAwEBPxAEZf/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EKU//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERUTGx/9oACAEBAAE/EOWeDhUTa+CP/9k=","aspectRatio":2.380952380952381,"src":"/static/1b7ed065a955067d357d9fcf52afe07b/b4fce/15168338-8d30-4154-ace7-ea253220a01a_photo_2020-01-04_02-19-25.jpg","srcSet":"/static/1b7ed065a955067d357d9fcf52afe07b/42007/15168338-8d30-4154-ace7-ea253220a01a_photo_2020-01-04_02-19-25.jpg 269w,\n/static/1b7ed065a955067d357d9fcf52afe07b/0a4bb/15168338-8d30-4154-ace7-ea253220a01a_photo_2020-01-04_02-19-25.jpg 536w,\n/static/1b7ed065a955067d357d9fcf52afe07b/b4fce/15168338-8d30-4154-ace7-ea253220a01a_photo_2020-01-04_02-19-25.jpg 1071w,\n/static/1b7ed065a955067d357d9fcf52afe07b/1debf/15168338-8d30-4154-ace7-ea253220a01a_photo_2020-01-04_02-19-25.jpg 1200w","sizes":"(max-width: 1071px) 100vw, 1071px","presentationWidth":1071}}}}}},{"__typename":"PrismicPostBodyText","slice_type":"text","id":"Prismic__PostBodyText__Prismic__Post__XokyZBAAACMArb6k__body__1","primary":{"text":{"html":"<p>Я хотел начать орать, но рано. Тип яндух сохраняет и отдает не экранированные данные, а потом вспомнил, ШО ТАК И НАДО!</p><p>Знаете же какая лучшая практика против XSS всяких? Экранировать при <strong>ВЫВОДЕ</strong>, а не <strong>ВВОДЕ</strong>!</p><p>Почему? Да потому что если выйдет найти место без фильтра на ввод (ну или тупо в базу запись вставить), то пассивная XSS начнёт работать везде, где есть вывод этих данных.</p><p>С другой стороны, такой подход обязывает всех использующих API экранировать у себя локально и вероятность того, что где-нить прогер забудет это сделать высока.</p><p>Короче я бы зарофлил и пошёл фигачить ХСС в приложухи яндуха)0)) </p><p>UPD. Они в своих прилах вообще юзают HTML вставки для банеров там всяких и прочей лабуды)))</p><p>UPD2. Норм люди обёртку над выводом пилят, я тоже адекватным стараюсь быть</p><p>Держите еще ссылку на вики шо это, некоторым полезно <a  href=\"https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D0%B6%D1%81%D0%B0%D0%B9%D1%82%D0%BE%D0%B2%D1%8B%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%B8%D0%BD%D0%B3\">Межсайтовый скриптинг</a></p>"}}},{"__typename":"PrismicPostBodyCodeBlock","slice_type":"code_block","id":"Prismic__PostBodyCodeBlock__Prismic__Post__XokyZBAAACMArb6k__body__2","primary":{"code_block":{"html":"<pre class=\"language-python\"><code class=\"language-python\">text <span class=\"token operator\">=</span> TextBuilder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntext<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'Моя музыка'</span></span><span class=\"token punctuation\">)</span>\ntext<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;b>{display_name}&lt;/b>'</span><span class=\"token punctuation\">,</span> display_name<span class=\"token operator\">=</span>context<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>account<span class=\"token punctuation\">.</span>display_name<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> line<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        escaped_values <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">:</span> escape<span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> key<span class=\"token punctuation\">,</span> value <span class=\"token keyword\">in</span> values<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></code></pre>"}}},{"__typename":"PrismicPostBodyText","slice_type":"text","id":"Prismic__PostBodyText__Prismic__Post__XokyZBAAACMArb6k__body__3","primary":{"text":{"html":"<p>Сойдёёёёт, так давно с <code class=\"language-text\">.format </code>не работал, ужас.</p><p><em>escape</em> из пакета <em>html</em></p>"}}}]}},"posts":{"nodes":[{"id":"Prismic__Post__ZYgWYhAAACYAKMp2","uid":"2023","data":{"title":{"text":"Итоги Года 2023"},"date":"31.12.2023","categories":[{"category":{"document":[{"id":"Prismic__Category__Y635ZxAAACQAwo9V","uid":"results-of-the-year","data":{"name":"Итоги Года"}}]}}]}},{"id":"Prismic__Post__Y62KDBAAACYAwfBO","uid":"2022","data":{"title":{"text":"Итоги Года 2022"},"date":"31.12.2022","categories":[{"category":{"document":[{"id":"Prismic__Category__Y635ZxAAACQAwo9V","uid":"results-of-the-year","data":{"name":"Итоги Года"}}]}}]}},{"id":"Prismic__Post__Y639RhAAACMAwpTU","uid":"2021","data":{"title":{"text":"Итоги Года 2021"},"date":"31.12.2021","categories":[{"category":{"document":[{"id":"Prismic__Category__Y635ZxAAACQAwo9V","uid":"results-of-the-year","data":{"name":"Итоги Года"}}]}}]}},{"id":"Prismic__Post__Y64jWxAAACQAwssK","uid":"2020","data":{"title":{"text":"Итоги Года 2020"},"date":"31.12.2020","categories":[{"category":{"document":[{"id":"Prismic__Category__Y635ZxAAACQAwo9V","uid":"results-of-the-year","data":{"name":"Итоги Года"}}]}}]}}]}},"pageContext":{"uid":"xss-ne-eskeypnutye-dannye-u-yandeks"}}}